{% extends "layout.html" %}

{% set title = "Timeline" %}

{% block styles %}
<link rel="stylesheet" href="/static/styles/timeline.css">
{% endblock %}

{% block content %}
<div class="timeline-container">
  <div class="timeline-form-section">
    <h2>Make a Timeline Post</h2>
    
    <form class="timeline-form">
      <div class="form-group">
        <label for="name">Name:</label>
        <input type="text" name="name" id="name" required />
      </div>
      
      <div class="form-group">
        <label for="email">Email:</label>
        <input type="email" name="email" id="email" required />
      </div>
      
      <div class="form-group">
        <label for="content">Content:</label>
        <textarea name="content" id="content" rows="4" required placeholder="Share what's on your mind..."></textarea>
      </div>
      
      <button type="submit" class="submit-btn">Post to Timeline</button>
    </form>
  </div>

  <div class="timeline-posts-section">
    <h2>Recent Posts</h2>
    <div class="timeline-posts">
      {% for post in posts %}
        <div class="timeline-post">
          <h3>{{ post.name }}</h3>
          <p>{{ post.content }}</p>
        </div>
      {% endfor %}
    </div>
  </div>
</div>

<script>
  const form = document.querySelector('.timeline-form');

  form.addEventListener('submit', async (e) => {
    e.preventDefault();

    const name = document.getElementById('name').value;
    const email = document.getElementById('email').value;
    const content = document.getElementById('content').value;

    const formData = new FormData(document.querySelector('.timeline-form'));

    await fetch('/api/timeline_post', {
      method: 'POST',
      body: formData,
    });

    window.location.reload();
  });
</script>

{% endblock %}